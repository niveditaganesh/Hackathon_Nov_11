<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css2?family=PT+Serif&display=swap" rel="stylesheet">

    <title>FRESH DESK</title>

    <style>
body{
    background-color: rgb(126, 112, 139);
    margin: 20px;
    padding:20px;
    font-family: Georgia, 'Times New Roman', Times, serif;
}  
    </style>
    </head>
  <body>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" 
    crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" 
    crossorigin="anonymous"></script>

    <nav class="navbar navbar-expand-lg bg-dark navbar-dark">
        <a class="navbar-brand" href="https://developers.freshdesk.com/">FreshDesk</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link" href="index.html">Home </a>
            </li>
            <li class="nav-item ">
              <a class="nav-link" href="createTicket.html">Create Ticket</a>
            </li>
            <li class="nav-item ">
              <a class="nav-link" href="tickets.html">List of Tickets</a>
            </li>
            <li class="nav-item active">
              <a class="nav-link " href="#">List of Contacts<span class="sr-only">(current)</span></a>
            </li>
          </ul>
        </div>
      </nav>
<br><br>

    <div class="modal fade" id="contactModal" tabindex="-1" aria-labelledby="contactModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="contactModalLabel">EDIT CONTACT</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
             <p>When someone reaches out to you, they become a contact in your account. You can create companies and associate contacts with them.</p>
                <form>
                    <div class="form-group">
                      <label for="fullname">Full Name<sup style="color:red">*</sup></label>
                      <input type="text" class="form-control" id="fullname" placeholder="Enter the name of this person">
                    </div>
                    <div class="form-group">
                        <label for="title">Title</label>
                        <input type="text" class="form-control" id="title" placeholder="Enter the title">
                      </div>
                      <div class="form-group">
                        <label for="email">Email</label>
                        <input type="email" class="form-control" id="email" placeholder="Enter an email address">
                      </div>
                      <div class="form-group">
                        Atleast one of these fields is mandatory <sup style="color:red">*</sup>
                      <div class="form-group">
                        <label for="wrkph">Work Phone</label>
                        <input type="tel" class="form-control" id="wrkph" placeholder="Enter an Telephone number">
                      </div>
                      <div class="form-group">
                        <label for="mobph">Mobile</label>
                        <input type="tel" class="form-control" id="mobph" placeholder="Enter an Mobile number">
                      </div>
                      <div class="form-group">
                        <label for="twitter">Twitter</label>
                        <input type="email" class="form-control" id="twitter" placeholder="Enter a twitter id">
                      </div>
                      <div class="form-group">
                        <label for="externalid">Facebook</label>
                        <input type="email" class="form-control" id="facebook" placeholder="Enter a Facebook id">
                      </div>
                    </div>
                    <div class="form-group">
                        <label for="company">Unique External Id</label>
                        <input type="text" class="form-control" id="company" placeholder="Enter the company name">
                      </div>
                    <div class="form-group">
                      <label for="address">Address</label>
                      <textarea class="form-control" id="address" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="time">Time Zone</label>
                        <select class="form-control" id="language">
                            <option>--</option>
                            <option selected>(GMT-05:00) Eastern Time (US & Canada)</option>
                          <option value="Indiana">(GMT-05:00) Indiana (East)</option>
                          <option value='Hawaii'>(GMT-10:00) Hawaii</option>
                          <option value='UTC'>(GMT+00:00) UTC</option>
                          <option value='Dublin'>(GMT+00:00) Dublin</option>
                          <option value='Belgrade'>(GMT+01:00) Belgrade</option>
                          <option value='Kabul'>(GMT+04:30) Kabul</option>
                          <option value='Chennai'>(GMT+05:30) Chennai</option>
                          <option value='Kathmandu'>(GMT+05:45) Kathmandu</option>
                          <option value='Rangoon'>(GMT+06:30) Rangoon</option>
                        </select>
                      </div>
                    <div class="form-group">
                        <label for="language">Language</label>
                        <select class="form-control" id="language">
                            <option>--</option>
                            <option value='Arabian'>Arabian</option>
                          <option value='English' selected>English</option>
                          <option value='Estonian'>Estonian</option>
                          <option value='Filipino'>Filipino</option>
                          <option value='Finnish'>Finnish</option>
                          <option value='French'>French</option>
                          <option value='German'>German</option>
                          <option value='Tamil'>Tamil</option>
                          <option value='Telugu'>Telugu</option>
                          <option value='Vietnamese'>Vietnamese</option>
                        </select>
                      </div>
                    <div class="form-group">
                        <label for="tagcont">Tags</label>
                        <input type="text" class="form-control" id="tagcont">
                      </div>
                      <div class="form-group">
                        <label for="about">About</label>
                        <textarea class="form-control" id="about" rows="3"></textarea>
                      </div>
                  </form>
    
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
              <button type="button" class="btn btn-success" onclick="UpdateContact()">Save</button>
            </div>
          </div>
        </div>
      </div>

    <script src='script.js'></script>
    <script>
        var obj=[];
     var container =document.createElement('div')
        container.setAttribute('class','container-fluid')
        var table =document.createElement('div')
        table.setAttribute('class','table table-light')
        var thead =document.createElement('thead')
        var trh= document.createElement('tr')
        trh.setAttribute('scope','row')
        var th1=document.createElement('th')
        th1.setAttribute('scope','col')
        th1.innerHTML="ID"
        var th2=document.createElement('th')
        th2.setAttribute('scope','col')
        th2.innerHTML="CONTACT"
        var th3=document.createElement('th')
        th3.setAttribute('scope','col')
        th3.innerHTML="TITLE"
        var th4=document.createElement('th')
        th4.setAttribute('scope','col')
        th4.innerHTML="COMPANY"
        var th5=document.createElement('th')
        th5.setAttribute('scope','col')
        th5.innerHTML="EMAIL"
        var th6=document.createElement('th')
        th6.setAttribute('scope','col')
        th6.innerHTML="WORK PHONE"
        var th7=document.createElement('th')
        th7.setAttribute('scope','col')
        th7.innerHTML="FACEBOOK ID"
        var th8=document.createElement('th')
        th8.setAttribute('scope','col')
        th8.innerHTML="TWITTER ID"
        var th9=document.createElement('th')
        th9.setAttribute('scope','col')
        th9.innerHTML="     "
        var th10=document.createElement('th')
        th10.setAttribute('scope','col')
        th10.innerHTML="    "
        trh.append(th1,th2,th3,th4,th5,th6,th7,th8,th9,th10)
        thead.append(trh)
        var tbody=document.createElement('tbody')
        tbody.setAttribute('id','tbody')
        table.append(thead,tbody)
        container.append(table)
        document.body.append(container)

function getContact(){
   var tbody1=document.getElementById('tbody')
    fetch("https://newaccount1605092002696.freshdesk.com/api/v2/contacts", {
  headers: {
    Authorization: "Basic SXBYNDV0dmdDOU43cGlDSEhmY0U6WA=="
  }
}).then((resp)=>{
    return resp.json()
}).then((result)=>{
    console.log(result);
    result.forEach(element=>{
       
        var tr= document.createElement('tr')
        var td1=document.createElement('td')
        td1.innerHTML=element.id
        td1.id='cid'
        var td2=document.createElement('td')
        td2.innerHTML=element.name
        var td3=document.createElement('td')
        td3.innerHTML=element.job_title
        var td7=document.createElement('td')
        td7.innerHTML=element.company_id
        var td4=document.createElement('td')
        td4.innerHTML=element.email
        var td8=document.createElement('td')
        td8.innerHTML=element.phone
        var td5=document.createElement('td')
        td5.innerHTML=element.facebook_id
        var td6=document.createElement('td')
        td6.innerHTML=element.twitter_id
        var td9=document.createElement('td')
        var update=document.createElement('button')
        update.id='update'
        update.setAttribute('class','btn btn-warning')
        update.setAttribute('data-toggle','modal')
        update.setAttribute('data-target','#contactModal')
        update.innerHTML='Update'
        td9.append(update)
        var td10=document.createElement('td')
        var Delete=document.createElement('button')
        Delete.setAttribute('class','btn btn-danger')
        Delete.innerHTML='Delete'
        td10.append(Delete)
        tr.append(td1,td2,td3,td7,td4,td8,td5,td6,td9,td10)
        tbody1.append(tr)
        update.addEventListener('click',()=>{
                  
            EditContact(element.name,element.job_title,element.email,element.id,element.phone,element.facebook_id,element.twitter_id)
        })
        Delete.addEventListener('click',()=>{
    DeleteContact(element.id);
})
obj.push((element.email),(element.id))
    })
    
}).catch((err)=>{console.log(err)})
}
getContact();

function checkforRequestor(){
for(i=0;i<obj.length;i++){
    if(obj[i]==localStorage.getItem("checkkey")){
        requester=obj[i+1];
        localStorage.setItem("anskey", requester);
    }
}
}
function EditContact(name,job_title,email,cid,wrkph,facebook,twitter){
    document.getElementById('fullname').value = name;
    document.getElementById('title').value = job_title;
    document.getElementById('email').value = email;
    document.getElementById('cid').value = cid;
    document.getElementById('wrkph').value = wrkph;
    document.getElementById('facebook').value = facebook;
    document.getElementById('twitter').value = twitter;
}
function UpdateContact(){
    let ID=document.getElementById('cid').value
    fetch(`https://newaccount1605092002696.freshdesk.com/api/v2/contacts/${ID}`, {
  body: JSON.stringify({name:document.getElementById('fullname').value,
    job_title:document.getElementById('title').value,
    email:document.getElementById('email').value,phone:document.getElementById('wrkph').value,
     }),
  headers: {
    Authorization: "Basic SXBYNDV0dmdDOU43cGlDSEhmY0U6WA==",
    "Content-Type": "application/json"
  },
  method: "PUT"
}).then((resp)=>{
    return resp.json()
}).then((result)=>{
    console.log(result);
}).catch((err)=>{console.log(err)})
window.location.reload();
}

function DeleteContact(cid){
    let check = confirm("Are you sure you want to perform this action");
    if(check){
    fetch(`https://newaccount1605092002696.freshdesk.com/api/v2/contacts/${cid}`, {
  headers: {
    Authorization: "Basic SXBYNDV0dmdDOU43cGlDSEhmY0U6WA=="
  },
  method: "DELETE"
}).catch((err)=>{console.log(err)})
}
window.location.reload();
}
$( "#update" ).click(function() {
  $('#contactModal').modal('show')
});


    </script>
    </body>
    </html>